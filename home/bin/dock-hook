#!/bin/bash
# Set up displays using xrandr as appropriate

printf "dock added or removed, updating status" | systemd-cat -t dock-hook

# When udev calls this, there won't be DISPLAY set, so do that here
if [[ -z "$DISPLAY" ]]; then
    export DISPLAY=:0
fi

# See if the docking station is attached
if xrandr | grep -q 'DP-1-1 connected'; then
    printf "dock detected, enabling displays" | systemd-cat -t dock-hook

    xrandr \
           --output DP-1-2 --auto --rotate left --pos 0x0 --primary \
           --output DP-1-1 --auto --pos 1080x404 \
           --output eDP-1 --off
else
    printf "dock absent, enabling internal screen" | systemd-cat -t dock-hook

    xrandr --output eDP-1 --auto \
           --output DP-1-1 --off \
           --output DP-1-2 --off
fi
